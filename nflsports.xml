<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<items xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">


<item>
<title>[COLOR blue]NFL Now[/COLOR]</title>
<link>http://nflioslivesvg2-i.akamaihd.net/hls/live/221521/nflioslive/2015HackerNow_w99d9_h.m3u8|User-Agent=Mozilla/5.0 (iPhone; CPU iPhone OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile Safari/600.1.4</link>
<thumbnail></thumbnail>
</item>

<item>
<title>NFL NOW RegEx</title>
<link>plugin://plugin.video.f4mTester/?url=$doregex[getURL]&amp;streamtype=HLS</link>
<regex>
<name>getURL</name>
<expres>840400.*\s*(http.*m3u8)</expres>
<page>http://nflioslivesvg2-i.akamaihd.net/hls/live/221521/nflioslive/2015HackerNow_w99d9.m3u8</page>
</regex>
</item>

<item>
<title>.NFL NOW</title> 
<link>http://nflioslivesvg2-i.akamaihd.net/hls/live/221521/nflioslive/2015HackerNow_w99d9.m3u8|User-Agent=Mozilla/5.0 (iPhone; CPU iPhone OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile Safari/600.1.4|Cookie=$doregex[getPHPSESSID]|Buffer=20971520 live=1 timeout=30</link> 
<regex>
<name>getPHPSESSID</name>
<expres>(PHPSESSID.*?);</expres>
<page>http://nflioslivesvg2-i.akamaihd.net/hls/live/221521/nflioslive/2015HackerNow_w99d9.m3u8</page>
<cookieJar></cookieJar>
<agent>Mozilla/5.0 (iPhone; CPU iPhone OS 8_0_2 like Mac OS X) AppleWebKit/600.1.4 (KHTML, like Gecko) Version/8.0 Mobile Safari/600.1.4</agent>
<noredirect>true</noredirect>
<includeheaders><includeheaders/>
</regex>
</item>


<!--------------------NFL NETWORK-------------------->
<item>
<title>.NFL NETWORK</title>
<link>$doregex[loadcookie]$doregex[get-rtmp-code]$doregex[savecookie]</link>


<regex>
<name>savecookie</name>
<expres></expres>
<page></page>
<cookieJar>save[streamlive1.lwp]</cookieJar>
</regex>

<regex>
<name>get-rtmp-code</name>


<expres><![CDATA[#$pyFunction
import requests,xbmcgui,xbmc
import re,os,time
import xbmcaddon,xbmc,cookielib

def calculateauto(question):
    try:
        ans=str(eval(question.split(':')[-1].replace('=?','').strip()))
        print 'q2'
    except: 
        ans=question.split(':')[-1].strip()
        print 'q3'
        
    return ans

def GetLSProData(page_data,Cookie_Jar,m,url='http://www.streamlive.to/view/70295/'):

 headers = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0'}
 page =url
 session = requests.Session()
 if Cookie_Jar==None:
  Cookie_Jar=cookielib.LWPCookieJar()
 session.cookies = Cookie_Jar

 source = session.get(page, headers=headers )

 question = re.findall('(Question.*?)\<', source.text)
 if len(question)>0:
  question=question[0]
  print question
  addon       = xbmcaddon.Addon()

  autodone=False
  try:
   
   text=calculateauto(question)
   data = {"captcha": text}
   headers2 = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0', 'Content-Type': 'application/x-www-form-urlencoded', 'Referer': page}
   source2= session.post(page, headers = headers2, data= data)   
   question = re.findall('(Question.*?)\<', source2.text)
   if len(question)>0:
    question=question[0]
   else:
    autodone=True
  except: pass
  
  if not autodone:
   text=takeInputFortext(question)
   data = {"captcha": text}
   headers2 = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0', 'Content-Type': 'application/x-www-form-urlencoded', 'Referer': page}
   source2= session.post(page, headers = headers2, data= data)
 else:
  source2=source

 tokpg = re.findall('getJSON\("(.*?)"', source2.text)[0]
 xs = re.findall('(\?xs=.*?)"', source2.text)[0]
 rtmp = re.findall('rtmp:.*?(wat.*?)1935', source2.text)[0]
 playpath = re.findall('file: "(.*).flv', source2.text)[0]

 headers3 = {'User-Agent': 'Mozilla/5.0 (X11; Linux i686; rv:42.0) Gecko/20100101 Firefox/42.0 Iceweasel/42.0', 'Referer': 'https://www.streamlive.to'}

 source3 = session.get(tokpg, headers=headers3)
 token = re.findall('token":"(.*?)"', source3.text)[0]



 return 'rtmp://' + rtmp + ':1935/edge app=edge/_definst_/' + xs + ' playpath=' + playpath + ' swfVfy=1 token=' + token + ' swfUrl=https://www.streamlive.to/ads/streamlive.swf pageUrl=https://www.streamlive.to live=1 timeout=15'

def takeInputFortext(txt):
 addon = xbmcaddon.Addon('plugin.video.live.streamspro')
 addon_version = addon.getAddonInfo('version')
 profile = xbmc.translatePath(addon.getAddonInfo('profile').decode('utf-8'))
 
 solver = InputWindow( txt=txt)
 solution = solver.get()
 return solution

class InputWindow(xbmcgui.WindowDialog):
    def __init__(self, *args, **kwargs):

        
        self.txt = kwargs.get('txt','')

        xbmcgui.WindowXMLDialog.__init__(self)
        #self.addControl(self.txt)
        path = xbmcaddon.Addon().getAddonInfo('path')
        self.kbd = xbmc.Keyboard()
        self.kbd.setHeading( self.txt)



    def get(self):
        self.show()
        time.sleep(2)
        self.kbd.doModal()
        if (self.kbd.isConfirmed()):
            text = self.kbd.getText()
            self.close()
            return text
        self.close()
        return False
        
]]></expres>
<page></page>
</regex>

<regex>
<name>loadcookie</name>
<expres></expres>
<page></page>
<cookieJar>open[streamlive1.lwp]</cookieJar>
</regex>

</item>


<!----------------BEGIN
<item>
<title>[COLOR blue]NFL Network[/COLOR]</title>
<link>$doregex[select_Url]</link>
<regex>
<name>select_Url</name>
<expres>$pyFunction: '$doregex[get_SD]' if not '$doregex[get_SD]'=='' else '$doregex[get_SD]'</expres>
<page></page>
</regex><regex>
<name>get_SD</name>
<expres>$pyFunction:vipracing.decrypt_vipracing('http://www.streamlive.to/view/70295',False,False)</expres>
<page></page>
</regex>
<regex><name>get_SD</name>
<expres>$pyFunction:vipracing.decrypt_vipracing('http://www.streamlive.to/view/72886',False,False)</expres>
<page></page>
</regex>
</item>
--------------------------------END-->
<item>
<title>[COLOR blue]NFL Network[/COLOR] (wait few seconds) MMHD</title>
<sportsdevil>http://mamahd.com/watch-nfl-network-live-stream-free-1.html</sportsdevil>
<referer>http://www.vipbox.sx/</referer>
<thumbnail></thumbnail>
</item>

<!-- REGEX PARA STREMLIVE.TO -->

<item>
<title>[COLOR blue]NFL Network[/COLOR] Regex SL.to 1</title>
<link>rtmp://watch4.streamlive.to:1935/edge app=edge/_definst_/$doregex[xs] playpath=$doregex[path] swfVfy=1 token=$doregex[tok] swfUrl=http://www.streamlive.to/ads/streamlive.swf pageUrl=http://www.streamlive.to live=1 timeout=15</link>
<regex>
        <name>path</name>
        <expres>file: "(.*).flv</expres>
        <page>http://www.streamlive.to/view/72886</page>
</regex>
<regex>
        <name>tok</name>
        <expres>token":"([^"]*)</expres>
        <page>$doregex[tokpg]</page>
        <referer>http://www.streamlive.to</referer>
</regex>
<regex>
        <name>tokpg</name>
        <expres>getJSON."(.*?)"</expres>
        <page>http://www.streamlive.to/view/72886</page>
</regex>
<regex>
        <name>xs</name>
        <expres>/(\?xs=.*?)"</expres>
        <page>http://www.streamlive.to/view/72886</page>
        <rawpost>captcha=$doregex[answer]</rawpost>
        <referer>http://www.streamlive.to</referer>
        <cookieJar></cookieJar>
        <ignorecache/>
</regex>
<regex>
        <name>answer</name>
        <expres>$pyFunction:($doregex[captcha])</expres>
        <page></page>
</regex>
<regex>
        <name>captcha</name>
        <expres>$pyFunction:'$doregex[xcaptcha]'.replace('x','*')</expres>
        <page></page>
</regex>
<regex>
        <name>xcaptcha</name>
        <expres>Question: (.*) =</expres>
        <page>http://www.streamlive.to/view/72886</page>
        <referer>http://www.streamlive.to</referer>
        <cookieJar></cookieJar>
</regex>
<fanart></fanart>
<thumbnail></thumbnail>   

</item>
<!-----WORKING RGX FROM STRML1VE.TO ---------------->	
<item>
<title>[COLOR blue]NFL Network[/COLOR] Regex SL.to 2</title>
<link>rtmp://watch4.streamlive.to:1935/edge app=edge/_definst_/$doregex[xs] playpath=$doregex[path] swfVfy=1 token=$doregex[tok] swfUrl=http://www.streamlive.to/ads/streamlive.swf pageUrl=http://www.streamlive.to live=1 timeout=15</link>
<regex>
        <name>path</name>
        <expres>file: "(.*).flv</expres>
        <page>http://www.streamlive.to/view/70295/</page>
</regex>
<regex>
        <name>tok</name>
        <expres>token":"([^"]*)</expres>
        <page>$doregex[tokpg]</page>
        <referer>http://www.streamlive.to</referer>
</regex>
<regex>
        <name>tokpg</name>
        <expres>getJSON."(.*?)"</expres>
        <page>http://www.streamlive.to/view/70295/</page>
</regex>
<regex>
        <name>xs</name>
        <expres>/(\?xs=.*?)"</expres>
        <page>http://www.streamlive.to/view/70295/</page>
        <rawpost>captcha=$doregex[answer]</rawpost>
        <referer>http://www.streamlive.to</referer>
        <cookieJar></cookieJar>
        <ignorecache/>
</regex>
<regex>
        <name>answer</name>
        <expres>$pyFunction:($doregex[captcha])</expres>
        <page></page>
</regex>
<regex>
        <name>captcha</name>
        <expres>$pyFunction:'$doregex[xcaptcha]'.replace('x','*')</expres>
        <page></page>
</regex>
<regex>
        <name>xcaptcha</name>
        <expres>Question: (.*) =</expres>
        <page>http://www.streamlive.to/view/70295/</page>
        <referer>http://www.streamlive.to</referer>
        <cookieJar></cookieJar>
</regex>
<fanart></fanart>
<thumbnail></thumbnail>   

</item>


